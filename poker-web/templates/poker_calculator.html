<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>í¬ì»¤ ìŠ¹ë¥  ê³„ì‚°ê¸°</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      text-align: center;
      margin-bottom: 30px;
    }
    .input-section {
      margin-bottom: 30px;
      padding: 20px;
      border: 2px solid #ecf0f1;
      border-radius: 10px;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      color: #34495e;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }
    .section-title::before {
      content: "ğŸ¯";
      margin-right: 10px;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(13, 1fr);
      gap: 8px;
      margin-bottom: 15px;
    }
    .card {
      width: 50px;
      height: 75px;
      border: 2px solid #ddd;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 24px;
      font-weight: bold;
      transition: all 0.2s;
      background: white;
    }
    .card:hover {
      border-color: #3498db;
      transform: scale(1.05);
    }
    .card.selected {
      border-color: #e74c3c;
      background-color: #fdf2f2;
      color: #e74c3c;
    }
    .card.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .suit-symbols {
      font-size: 20px;
      margin-top: 3px;
    }
    .selected-cards {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      min-height: 85px;
      padding: 10px;
      background-color: #f8f9fa;
      border-radius: 5px;
    }
    .selected-card {
      width: 60px;
      height: 85px;
      border: 2px solid #e74c3c;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: #fdf2f2;
      color: #e74c3c;
      font-weight: bold;
      position: relative;
      font-size: 24px;
    }
    .selected-card .suit-symbols {
      font-size: 24px;
      margin-top: 3px;
    }
    .remove-card {
      position: absolute;
      top: -8px;
      right: -8px;
      width: 24px;
      height: 24px;
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .player-controls {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .add-player-btn, .remove-player-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    .add-player-btn {
      background-color: #27ae60;
      color: white;
    }
    .add-player-btn:hover {
      background-color: #229954;
    }
    .remove-player-btn {
      background-color: #e74c3c;
      color: white;
    }
    .remove-player-btn:hover {
      background-color: #c0392b;
    }
    .calculate-btn {
      background-color: #3498db;
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
      font-weight: bold;
    }
    .calculate-btn:hover {
      background-color: #2980b9;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      background-color: #ecf0f1;
      border-radius: 5px;
      border-left: 4px solid #3498db;
    }
    .error {
      color: #e74c3c;
      font-weight: bold;
    }
    .success {
      color: #27ae60;
      font-weight: bold;
    }
    .info {
      color: #7f8c8d;
      font-size: 14px;
      margin-top: 20px;
    }
    .clear-btn {
      background-color: #95a5a6;
      color: white;
      padding: 5px 10px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
      margin-left: 10px;
    }
    .clear-btn:hover {
      background-color: #7f8c8d;
    }
    .board-layout {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    .board-slot {
      width: 60px;
      height: 85px;
      border: 3px dashed #bdc3c7;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 5px;
      cursor: pointer;
      transition: all 0.2s;
      background: #f8f9fa;
    }
    .board-slot:hover {
      border-color: #3498db;
      background: #ebf3fd;
    }
    .board-slot.filled {
      border-style: solid;
      border-color: #e74c3c;
      background: #fdf2f2;
    }
    .board-slot.empty {
      color: #7f8c8d;
      font-size: 12px;
      text-align: center;
    }
    .board-slot.empty::after {
      content: "í´ë¦­í•˜ì—¬\nì¹´ë“œ ì„ íƒ";
      white-space: pre-line;
      font-size: 10px;
    }
    .hand-layout {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    .hand-slot {
      width: 60px;
      height: 85px;
      border: 3px dashed #bdc3c7;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 5px;
      cursor: pointer;
      transition: all 0.2s;
      background: #f8f9fa;
    }
    .hand-slot:hover {
      border-color: #3498db;
      background: #ebf3fd;
    }
    .hand-slot.filled {
      border-style: solid;
      border-color: #e74c3c;
      background: #fdf2f2;
    }
    .hand-slot.empty {
      color: #7f8c8d;
      font-size: 12px;
      text-align: center;
    }
    .hand-slot.empty::after {
      content: "í´ë¦­í•˜ì—¬\nì¹´ë“œ ì„ íƒ";
      white-space: pre-line;
      font-size: 10px;
    }
    .win-rates {
      margin: 15px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #28a745;
    }
    .player-win-rate {
      margin: 8px 0;
      padding: 8px;
      background: white;
      border-radius: 5px;
      border: 1px solid #dee2e6;
    }
    .player-win-rate:first-child {
      background: #d4edda;
      border-color: #c3e6cb;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¯ í¬ì»¤ ìŠ¹ë¥  ê³„ì‚°ê¸°</h1>
    <div class="info">
      <p>ì¹´ë“œë¥¼ í´ë¦­í•´ì„œ ì„ íƒí•˜ì„¸ìš”! (2ëª…~10ëª… í”Œë ˆì´ì–´ ì§€ì›)</p>
      <p>í”„ë¦¬í”Œë, í”Œë, í„´, ë¦¬ë²„ ëª¨ë“  ìƒí™©ì—ì„œ ì •í™•í•œ í™•ë¥  ê³„ì‚°!</p>
    </div>

    <!-- ë‚´ ì¹´ë“œ ì„ íƒ -->
    <div class="input-section">
      <div class="section-title">ë‚´ ì¹´ë“œ 2ì¥ ì„ íƒ</div>
      <div class="hand-layout" id="my-hand-layout">
        <div class="hand-slot empty" data-slot="0" onclick="selectHandSlot('my', 0)"></div>
        <div class="hand-slot empty" data-slot="1" onclick="selectHandSlot('my', 1)"></div>
      </div>
      <div class="card-grid" id="my-grid" style="display: none;">
        <!-- ì¹´ë“œë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
      </div>
      <div class="selected-cards" id="my-selected-cards">
        <div style="color: #7f8c8d; display: flex; align-items: center;">ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
      </div>
      <button class="clear-btn" onclick="clearSelection('my')">ì„ íƒ ì´ˆê¸°í™”</button>
    </div>

    <!-- ìƒëŒ€ í”Œë ˆì´ì–´ë“¤ -->
    <div class="input-section">
      <div class="section-title">ìƒëŒ€ í”Œë ˆì´ì–´ë“¤</div>
      <div id="opponents-container">
        <div class="opponent-section">
          <div style="font-weight: bold; margin-bottom: 10px;">ìƒëŒ€ 1 ì¹´ë“œ 2ì¥ ì„ íƒ</div>
          <div class="hand-layout" id="opp-1-hand-layout">
            <div class="hand-slot empty" data-slot="0" onclick="selectHandSlot('opp-1', 0)"></div>
            <div class="hand-slot empty" data-slot="1" onclick="selectHandSlot('opp-1', 1)"></div>
          </div>
          <div class="card-grid" id="opp-1-grid" style="display: none;"></div>
          <div class="selected-cards" id="opp-1-selected-cards">
            <div style="color: #7f8c8d; display: flex; align-items: center;">ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
          </div>
          <button class="clear-btn" onclick="clearSelection('opp-1')">ì„ íƒ ì´ˆê¸°í™”</button>
        </div>
      </div>
      <div class="player-controls">
        <button class="add-player-btn" onclick="addPlayer()">+ ìƒëŒ€ ì¶”ê°€</button>
        <button class="remove-player-btn" onclick="removePlayer()" style="display: none;">- ìƒëŒ€ ì œê±°</button>
      </div>
    </div>

    <!-- ë³´ë“œ ì¹´ë“œ ì„ íƒ -->
    <div class="input-section">
      <div class="section-title">ë³´ë“œ ì¹´ë“œ ì„ íƒ (0~5ì¥)</div>
      <div class="board-layout" id="board-layout">
        <div class="board-slot empty" data-slot="0" onclick="selectBoardSlot(0)"></div>
        <div class="board-slot empty" data-slot="1" onclick="selectBoardSlot(1)"></div>
        <div class="board-slot empty" data-slot="2" onclick="selectBoardSlot(2)"></div>
        <div class="board-slot empty" data-slot="3" onclick="selectBoardSlot(3)"></div>
        <div class="board-slot empty" data-slot="4" onclick="selectBoardSlot(4)"></div>
      </div>
      <div class="card-grid" id="board-cards-grid" style="display: none;">
        <!-- ì¹´ë“œë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
      </div>
      <div class="selected-cards" id="board-selected-cards">
        <div style="color: #7f8c8d; display: flex; align-items: center;">ë³´ë“œ ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)</div>
      </div>
      <button class="clear-btn" onclick="clearSelection('board')">ì„ íƒ ì´ˆê¸°í™”</button>
    </div>

    <button class="calculate-btn" onclick="calculate()">ìŠ¹ë¥  ê³„ì‚°í•˜ê¸°</button>

    <div class="result">
      <h3>ğŸ“Š ê³„ì‚° ê²°ê³¼</h3>
      <div id="result">ì—¬ê¸°ì— ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
    </div>

    <div class="info">
      <h4>ğŸ’¡ ì‚¬ìš©ë²•</h4>
      <ul>
        <li><strong>ì¹´ë“œ ì„ íƒ:</strong> í´ë¦­ìœ¼ë¡œ ì§ê´€ì ì¸ ì¹´ë“œ ì„ íƒ</li>
        <li><strong>ë³´ë“œ ì¹´ë“œ:</strong> 3ì¥(í”Œë), 4ì¥(í„´), 5ì¥(ë¦¬ë²„) ë˜ëŠ” 0ì¥(í”„ë¦¬í”Œë)ë§Œ ì§€ì›</li>
        <li><strong>í”Œë ˆì´ì–´:</strong> 2ëª…~10ëª…ê¹Œì§€ ì§€ì› (ë‚´ê°€ ì´ê¸°ë ¤ë©´ ëª¨ë“  ìƒëŒ€ë¥¼ ì´ê²¨ì•¼ í•¨)</li>
        <li><strong>ê³„ì‚° ë°©ì‹:</strong> ì •í™•í•œ ì¡°í•© ê³„ì‚° (í”„ë¦¬í”Œëë§Œ ì‹œë®¬ë ˆì´ì…˜)</li>
      </ul>
    </div>
  </div>

  <script>
    let playerCount = 1;
    let selectedCards = {
      'my': [],
      'board': []
    };
    
    // ìƒëŒ€ í”Œë ˆì´ì–´ë“¤ì˜ ì„ íƒëœ ì¹´ë“œ
    for (let i = 1; i <= 6; i++) {
      selectedCards[`opp-${i}`] = [];
    }

    // ë³´ë“œ ìŠ¬ë¡¯ ìƒíƒœ ê´€ë¦¬
    let boardSlots = [null, null, null, null, null];
    let currentBoardSlot = null;
    
    // í•¸ë“œ ìŠ¬ë¡¯ ìƒíƒœ ê´€ë¦¬
    let handSlots = {
      'my': [null, null]
    };
    let currentHandSlot = null;
    let currentHandPlayer = null;

    const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
    const suits = ['S', 'H', 'D', 'C'];
    const suitSymbols = {
      'S': 'â™ ',
      'H': 'â™¥', 
      'D': 'â™¦',
      'C': 'â™£'
    };

    // ë³´ë“œ ìŠ¬ë¡¯ ì„ íƒ
    function selectBoardSlot(slotIndex) {
      if (boardSlots[slotIndex] !== null) {
        // ì´ë¯¸ ì¹´ë“œê°€ ìˆëŠ” ìŠ¬ë¡¯ í´ë¦­ ì‹œ ì¹´ë“œ ì œê±°
        removeBoardCard(slotIndex);
        return;
      }
      
      currentBoardSlot = slotIndex;
      const cardGrid = document.getElementById('board-cards-grid');
      cardGrid.style.display = 'grid';
      cardGrid.scrollIntoView({ behavior: 'smooth' });
    }

    // ë³´ë“œ ì¹´ë“œ ì œê±°
    function removeBoardCard(slotIndex) {
      const cardCode = boardSlots[slotIndex];
      if (cardCode) {
        selectedCards.board = selectedCards.board.filter(card => card !== cardCode);
        boardSlots[slotIndex] = null;
        updateBoardDisplay();
        updateCardStates();
      }
    }

    // ë³´ë“œ í‘œì‹œ ì—…ë°ì´íŠ¸
    function updateBoardDisplay() {
      for (let i = 0; i < 5; i++) {
        const slot = document.querySelector(`#board-layout [data-slot="${i}"]`);
        const cardCode = boardSlots[i];
        
        if (cardCode) {
          slot.className = 'board-slot filled';
          const rank = cardCode.slice(0, -1);
          const suit = cardCode.slice(-1);
          slot.innerHTML = `
            <div style="font-size: 24px; font-weight: bold;">${rank}</div>
            <div style="color: ${suit === 'H' || suit === 'D' ? '#e74c3c' : '#2c3e50'}; font-size: 24px;">${suitSymbols[suit]}</div>
          `;
        } else {
          slot.className = 'board-slot empty';
          slot.innerHTML = '';
        }
      }
    }

    // í•¸ë“œ ìŠ¬ë¡¯ ì„ íƒ
    function selectHandSlot(player, slotIndex) {
      if (handSlots[player][slotIndex] !== null) {
        // ì´ë¯¸ ì¹´ë“œê°€ ìˆëŠ” ìŠ¬ë¡¯ í´ë¦­ ì‹œ ì¹´ë“œ ì œê±°
        removeHandCard(player, slotIndex);
        return;
      }
      
      currentHandPlayer = player;
      currentHandSlot = slotIndex;
      const cardGrid = document.getElementById(`${player}-grid`);
      
      if (cardGrid) {
        cardGrid.style.display = 'grid';
        cardGrid.scrollIntoView({ behavior: 'smooth' });
      }
    }

    // í•¸ë“œ ì¹´ë“œ ì œê±°
    function removeHandCard(player, slotIndex) {
      const cardCode = handSlots[player][slotIndex];
      if (cardCode) {
        selectedCards[player] = selectedCards[player].filter(card => card !== cardCode);
        handSlots[player][slotIndex] = null;
        updateHandDisplay(player);
        updateCardStates();
      }
    }

    // í•¸ë“œ í‘œì‹œ ì—…ë°ì´íŠ¸
    function updateHandDisplay(player) {
      const layout = document.getElementById(`${player}-hand-layout`);
      if (!layout) return;
      
      for (let i = 0; i < 2; i++) {
        const slot = layout.querySelector(`[data-slot="${i}"]`);
        const cardCode = handSlots[player][i];
        
        if (cardCode) {
          slot.className = 'hand-slot filled';
          const rank = cardCode.slice(0, -1);
          const suit = cardCode.slice(-1);
          slot.innerHTML = `
            <div style="font-size: 24px; font-weight: bold;">${rank}</div>
            <div style="color: ${suit === 'H' || suit === 'D' ? '#e74c3c' : '#2c3e50'}; font-size: 24px;">${suitSymbols[suit]}</div>
          `;
        } else {
          slot.className = 'hand-slot empty';
          slot.innerHTML = '';
        }
      }
    }

    // ì¹´ë“œ ê·¸ë¦¬ë“œ ìƒì„±
    function createCardGrid(containerId) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      
      ranks.forEach(rank => {
        suits.forEach(suit => {
          const card = document.createElement('div');
          card.className = 'card';
          card.dataset.rank = rank;
          card.dataset.suit = suit;
          card.dataset.card = rank + suit;
          
          card.innerHTML = `
            <div>${rank}</div>
            <div class="suit-symbols" style="color: ${suit === 'H' || suit === 'D' ? '#e74c3c' : '#2c3e50'}">${suitSymbols[suit]}</div>
          `;
          
          card.onclick = () => selectCard(containerId, rank + suit);
          container.appendChild(card);
        });
      });
    }

    // ì¹´ë“œ ì„ íƒ
    function selectCard(containerId, cardCode) {
      if (containerId === 'board-cards-grid') {
        // ë³´ë“œ ì¹´ë“œ ì„ íƒ
        if (currentBoardSlot === null) {
          alert('ë³´ë“œ ìŠ¬ë¡¯ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }
        
        if (isCardUsed(cardCode)) {
          alert('ì´ë¯¸ ì‚¬ìš©ëœ ì¹´ë“œì…ë‹ˆë‹¤.');
          return;
        }
        
        // ë³´ë“œ ìŠ¬ë¡¯ì— ì¹´ë“œ ì¶”ê°€
        boardSlots[currentBoardSlot] = cardCode;
        selectedCards.board.push(cardCode);
        
        updateBoardDisplay();
        updateCardStates();
        
        // ì¹´ë“œ ê·¸ë¦¬ë“œ ìˆ¨ê¸°ê¸°
        document.getElementById('board-cards-grid').style.display = 'none';
        currentBoardSlot = null;
        
        return;
      }
      
      // í•¸ë“œ ì¹´ë“œ ì„ íƒ (ë‚´ ì¹´ë“œ, ìƒëŒ€ ì¹´ë“œ)
      if (currentHandPlayer === null || currentHandSlot === null) {
        alert('í•¸ë“œ ìŠ¬ë¡¯ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (isCardUsed(cardCode)) {
        alert('ì´ë¯¸ ì‚¬ìš©ëœ ì¹´ë“œì…ë‹ˆë‹¤.');
        return;
      }
      
      // í•¸ë“œ ìŠ¬ë¡¯ì— ì¹´ë“œ ì¶”ê°€
      handSlots[currentHandPlayer][currentHandSlot] = cardCode;
      selectedCards[currentHandPlayer].push(cardCode);
      
      updateHandDisplay(currentHandPlayer);
      updateCardStates();
      
      // ì¹´ë“œ ê·¸ë¦¬ë“œ ìˆ¨ê¸°ê¸°
      document.getElementById(`${currentHandPlayer}-grid`).style.display = 'none';
      currentHandPlayer = null;
      currentHandSlot = null;
    }

    // ì¹´ë“œ ì‚¬ìš© ì—¬ë¶€ í™•ì¸
    function isCardUsed(cardCode) {
      for (const key in selectedCards) {
        if (selectedCards[key].includes(cardCode)) {
          return true;
        }
      }
      return false;
    }

    // ì„ íƒ í‚¤ ê°€ì ¸ì˜¤ê¸°
    function getSelectionKey(containerId) {
      if (containerId === 'my-grid') return 'my';
      if (containerId === 'board-cards-grid') return 'board';
      if (containerId.startsWith('opp-')) return containerId.replace('-grid', '');
      return 'my';
    }

    // ì¹´ë“œ í‘œì‹œ ì—…ë°ì´íŠ¸
    function updateCardDisplay(selectionKey) {
      const container = document.getElementById(`${selectionKey}-selected-cards`);
      container.innerHTML = '';
      
      if (selectedCards[selectionKey].length === 0) {
        const placeholder = selectionKey === 'board' ? 'ë³´ë“œ ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” (ì„ íƒì‚¬í•­)' : 'ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
        container.innerHTML = `<div style="color: #7f8c8d; display: flex; align-items: center;">${placeholder}</div>`;
        return;
      }
      
      selectedCards[selectionKey].forEach(cardCode => {
        const cardDiv = document.createElement('div');
        cardDiv.className = 'selected-card';
        const rank = cardCode.slice(0, -1);
        const suit = cardCode.slice(-1);
        
        cardDiv.innerHTML = `
          <div>${rank}</div>
          <div style="color: ${suit === 'H' || suit === 'D' ? '#e74c3c' : '#2c3e50'}">${suitSymbols[suit]}</div>
          <button class="remove-card" onclick="removeCard('${selectionKey}', '${cardCode}')">Ã—</button>
        `;
        container.appendChild(cardDiv);
      });
    }

    // ì¹´ë“œ ì œê±°
    function removeCard(selectionKey, cardCode) {
      selectedCards[selectionKey] = selectedCards[selectionKey].filter(card => card !== cardCode);
      updateCardDisplay(selectionKey);
      updateCardStates();
    }

    // ì¹´ë“œ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì‚¬ìš©ëœ ì¹´ë“œ ë¹„í™œì„±í™”)
    function updateCardStates() {
      const allCards = document.querySelectorAll('.card');
      allCards.forEach(card => {
        const cardCode = card.dataset.card;
        if (isCardUsed(cardCode)) {
          card.classList.add('disabled');
        } else {
          card.classList.remove('disabled');
        }
      });
    }

    // ì„ íƒ ì´ˆê¸°í™”
    function clearSelection(selectionKey) {
      selectedCards[selectionKey] = [];
      
      if (selectionKey === 'board') {
        // ë³´ë“œ ìŠ¬ë¡¯ ì´ˆê¸°í™”
        boardSlots = [null, null, null, null, null];
        updateBoardDisplay();
        document.getElementById('board-cards-grid').style.display = 'none';
        currentBoardSlot = null;
      } else {
        // í•¸ë“œ ìŠ¬ë¡¯ ì´ˆê¸°í™”
        if (handSlots[selectionKey]) {
          handSlots[selectionKey] = [null, null];
          updateHandDisplay(selectionKey);
          document.getElementById(`${selectionKey}-grid`).style.display = 'none';
          currentHandPlayer = null;
          currentHandSlot = null;
        }
      }
      
      updateCardStates();
    }

    // ìƒëŒ€ í”Œë ˆì´ì–´ ì¶”ê°€
    function addPlayer() {
      if (playerCount < 9) {
        playerCount++;
        const container = document.getElementById('opponents-container');
        const newPlayer = document.createElement('div');
        newPlayer.className = 'opponent-section';
        newPlayer.style.marginTop = '20px';
        newPlayer.innerHTML = `
          <div style="font-weight: bold; margin-bottom: 10px;">ìƒëŒ€ ${playerCount} ì¹´ë“œ 2ì¥ ì„ íƒ</div>
          <div class="hand-layout" id="opp-${playerCount}-hand-layout">
            <div class="hand-slot empty" data-slot="0" onclick="selectHandSlot('opp-${playerCount}', 0)"></div>
            <div class="hand-slot empty" data-slot="1" onclick="selectHandSlot('opp-${playerCount}', 1)"></div>
          </div>
          <div class="card-grid" id="opp-${playerCount}-grid" style="display: none;"></div>
          <div class="selected-cards" id="opp-${playerCount}-selected-cards">
            <div style="color: #7f8c8d; display: flex; align-items: center;">ì¹´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
          </div>
          <button class="clear-btn" onclick="clearSelection('opp-${playerCount}')">ì„ íƒ ì´ˆê¸°í™”</button>
        `;
        container.appendChild(newPlayer);
        createCardGrid(`opp-${playerCount}-grid`);
        
        // ìƒˆë¡œìš´ í”Œë ˆì´ì–´ì˜ í•¸ë“œ ìŠ¬ë¡¯ ì´ˆê¸°í™”
        handSlots[`opp-${playerCount}`] = [null, null];
        
        document.querySelector('.remove-player-btn').style.display = 'inline-block';
        if (playerCount === 9) {
          document.querySelector('.add-player-btn').style.display = 'none';
        }
      }
    }

    // ìƒëŒ€ í”Œë ˆì´ì–´ ì œê±°
    function removePlayer() {
      if (playerCount > 1) {
        const container = document.getElementById('opponents-container');
        container.removeChild(container.lastElementChild);
        selectedCards[`opp-${playerCount}`] = [];
        playerCount--;
        
        document.querySelector('.add-player-btn').style.display = 'inline-block';
        if (playerCount === 1) {
          document.querySelector('.remove-player-btn').style.display = 'none';
        }
      }
    }

    // ê³„ì‚° ì‹¤í–‰
    function calculate() {
      // ì…ë ¥ ê²€ì¦
      if (selectedCards.my.length !== 2) {
        document.getElementById("result").innerHTML = '<span class="error">ë‚´ ì¹´ë“œë¥¼ ì •í™•íˆ 2ì¥ ì„ íƒí•´ì£¼ì„¸ìš”.</span>';
        return;
      }

      const opponents = [];
      for (let i = 1; i <= playerCount; i++) {
        if (selectedCards[`opp-${i}`].length === 2) {
          opponents.push(selectedCards[`opp-${i}`].join(' '));
        }
      }

      if (opponents.length === 0) {
        document.getElementById("result").innerHTML = '<span class="error">ìµœì†Œ 1ëª…ì˜ ìƒëŒ€ê°€ í•„ìš”í•©ë‹ˆë‹¤.</span>';
        return;
      }

      // ë³´ë“œ ì¹´ë“œ ê²€ì¦ - 1ì¥ ë˜ëŠ” 2ì¥ì€ í—ˆìš©í•˜ì§€ ì•ŠìŒ
      if (selectedCards.board.length === 1 || selectedCards.board.length === 2) {
        document.getElementById("result").innerHTML = '<span class="error">ë³´ë“œ ì¹´ë“œëŠ” 3ì¥(í”Œë), 4ì¥(í„´), 5ì¥(ë¦¬ë²„) ë˜ëŠ” ì•„ì˜ˆ ì„ íƒí•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤. 1ì¥ ë˜ëŠ” 2ì¥ë§Œ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>';
        return;
      }

      // ìƒí™© íŒë‹¨
      let situation = "";
      let calculationType = "";
      
      if (selectedCards.board.length === 0) {
        situation = "í”„ë¦¬í”Œë";
        calculationType = "ê³ ì •ë°€ ì‹œë®¬ë ˆì´ì…˜ (50,000ë²ˆ)";
      } else if (selectedCards.board.length === 3) {
        situation = "í”Œë";
        calculationType = "ì •í™•í•œ ê³„ì‚°";
      } else if (selectedCards.board.length === 4) {
        situation = "í„´";
        calculationType = "ì •í™•í•œ ê³„ì‚°";
      } else if (selectedCards.board.length === 5) {
        situation = "ë¦¬ë²„";
        calculationType = "ì •í™•í•œ ê³„ì‚°";
      }

      // ë¡œë”© í‘œì‹œ
      document.getElementById("result").innerHTML = '<span class="success">ğŸ”„ ì •í™•í•œ ê³„ì‚° ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</span>';

      // ë°±ì—”ë“œ API í˜¸ì¶œ
      fetch('http://localhost:5000/calculate', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          my_hand: selectedCards.my.join(' '),
          opponents: opponents,
          community: selectedCards.board.join(' ')
        })
      })
      .then(response => response.json())
      .then(data => {
        displayResults(data);
      })
      .catch(error => {
        document.getElementById("result").innerHTML = `
          <span class="error">
            ì„œë²„ ì—°ê²° ì˜¤ë¥˜: ${error.message}<br>
            ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.<br>
            ë¬¸ì œê°€ ì§€ì†ë˜ë©´ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.
          </span>
        `;
      });
    }

    function displayResults(data) {
      const resultsDiv = document.getElementById('result');
      resultsDiv.innerHTML = '';
      
      if (data.error) {
        resultsDiv.innerHTML = `<div class="error">${data.error}</div>`;
        return;
      }
      
      let html = '<div class="success">';
      html += '<h4>ê³„ì‚° ê²°ê³¼</h4>';
      
      if (data.win_rates && data.win_rates.length > 0) {
        html += '<div class="win-rates">';
        data.win_rates.forEach((rate, index) => {
          const playerName = index === 0 ? 'ë‚˜' : `í”Œë ˆì´ì–´ ${index}`;
          const percentage = (rate * 100).toFixed(2);
          html += `<div class="player-win-rate">
            <strong>${playerName}:</strong> ${percentage}%
          </div>`;
        });
        html += '</div>';
      }
      
      if (data.tie_rate !== undefined) {
        html += `<p><strong>ë¬´ìŠ¹ë¶€ í™•ë¥ :</strong> ${(data.tie_rate * 100).toFixed(2)}%</p>`;
      }
      
      if (data.total_combinations) {
        html += `<p><strong>ì´ ì¡°í•© ìˆ˜:</strong> ${data.total_combinations.toLocaleString()}</p>`;
      }
      
      if (data.calculation_time) {
        html += `<p><strong>ê³„ì‚° ì‹œê°„:</strong> ${data.calculation_time.toFixed(3)}ì´ˆ</p>`;
      }
      
      html += '</div>';
      resultsDiv.innerHTML = html;
    }

    // ì´ˆê¸°í™”
    window.onload = function() {
      createCardGrid('my-grid');
      createCardGrid('opp-1-grid');
      createCardGrid('board-cards-grid');
      
      // ëª¨ë“  í”Œë ˆì´ì–´ì˜ í•¸ë“œ ìŠ¬ë¡¯ ì´ˆê¸°í™” (9ëª…ê¹Œì§€)
      for (let i = 1; i <= 9; i++) {
        handSlots[`opp-${i}`] = [null, null];
      }
    };
  </script>
</body>
</html> 